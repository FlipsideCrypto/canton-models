version: 2

models:
  - name: core__dim_labels
    description: |-
      Dimension table containing address labels and metadata for Canton blockchain.
      This table provides human-readable names, project associations, and categorization
      for Canton addresses (party IDs), including validators, dApps, and other entities.

      **Key Use Cases:**
      - Enriching transfer and balance tables with readable address names
      - Identifying validator addresses and their associated entities
      - Categorizing addresses by project, type, and subtype
      - Filtering for specific entity types (e.g., validators, DSO members)

      **Important Relationships:**
      - Join to any table with party IDs/addresses using the `address` field
      - Common joins: `core__fact_transfers`, `gov__fact_validator_onboarding_events`

      **Commonly-used Fields:**
      - `address`: Canton party ID for joining with transaction/event tables
      - `label`: Project name providing high-level identification
      - `address_name`: Specific name for the address/entity
      - `label_type`/`label_subtype`: Hierarchical categorization

      **Important Notes:**
      - Deleted labels are automatically removed via post-hook
      - Incremental updates based on modified_timestamp
      - Search optimized for address lookups
    tests:
      - dbt_utils.recency:
          datepart: hour
          field: modified_timestamp
          interval: 72
    columns:
      - name: BLOCKCHAIN
        description: Blockchain identifier (always 'canton' for this model)
        tests:
          - not_null
          - accepted_values:
              values: ['canton']
      - name: CREATOR
        description: Entity or system that created the label
      - name: ADDRESS
        description: Canton party ID/address being labeled
        tests:
          - unique
          - not_null
      - name: LABEL_TYPE
        description: High-level category of the label (e.g., validator, dapp, dso_member)
      - name: LABEL_SUBTYPE
        description: Subcategory providing more specific classification
      - name: LABEL
        description: Project name providing primary identification for the address
      - name: ADDRESS_NAME
        description: Human-readable name for the specific address
      - name: DIM_LABELS_ID
        description: Unique identifier for the label record
        tests:
          - unique
          - not_null
      - name: INSERTED_TIMESTAMP
        description: Timestamp when the label was first created
        tests:
          - not_null
      - name: MODIFIED_TIMESTAMP
        description: Timestamp when the label was last modified
        tests:
          - not_null
